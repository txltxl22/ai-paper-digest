<!-- Modern Article Card Component -->
<article data-id='{{ e.id }}'>
  <!-- Header Section -->
  <div class="article-header">
    <div class="header-left">
      <div class="document-icon">ğŸ“„</div>
      <h2>
        <a href='{{ url_for("summary_detail.view_summary", arxiv_id=e.id) }}'>{{ e.id }}</a>
        <button class="abstract-trigger" title="æŸ¥çœ‹æ‘˜è¦" data-arxiv-id="{{ e.id }}" data-abstract="{{ e.abstract or '' }}" data-english-title="{{ e.english_title or '' }}">
          <span class="abstract-trigger-icon">ğŸ“</span>
        </button>
        {% if uid %}
          <button class="favorite-star-btn" title="{{ 'å·²æ”¶è— - ç‚¹å‡»å–æ¶ˆ' if e.is_favorited else 'æ”¶è—è¿™ç¯‡è®ºæ–‡' }}" data-id="{{ e.id }}" data-favorited="{{ 'true' if e.is_favorited else 'false' }}">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="{{ '#fbbf24' if e.is_favorited else 'none' }}" stroke="currentColor" stroke-width="2">
              <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26 12,2"/>
            </svg>
          </button>
        {% endif %}
      </h2>
    </div>
    <div class="header-right">
      <div class="source-badge">
        {% if e.source_type == "user" %}
          <span class="user-chip" title="ç”¨æˆ·ä¸Šä¼ ">ğŸ‘¤ {{ e.user_id or "ç”¨æˆ·" }}</span>
        {% else %}
          <span class="user-chip" title="ç³»ç»Ÿè‡ªåŠ¨å¤„ç†">ğŸ¤– ç³»ç»Ÿ</span>
        {% endif %}
      </div>
      <div class="update-time">{{ e.updated.strftime('%m-%d %H:%M') }}</div>
    </div>
  </div>
  
  <!-- Tags Section -->
  {% if e.top_tags and e.top_tags|length %}
  <div class="tag-row top-tags">
    {% set search_q = search_query or '' %}
    {% set tag_q = tag_query or '' %}
    {% for tg in e.top_tags %}
      <a class="top-chip {% if search_q and (search_q.lower() in tg.lower()) %}search-hit{% elif tag_q and (tag_q in tg) %}query-hit{% endif %}" href='{{ url_for("index_page.index") }}?top={{ tg }}'>{{ tg }}</a>
    {% endfor %}
  </div>
  {% endif %}
  
  {% if e.detail_tags and e.detail_tags|length %}
  <div class="tag-row detail-tags">
    {% set search_q = search_query or '' %}
    {% set tag_q = tag_query or '' %}
    {% for tg in e.detail_tags[:18] %}
      <a class="tag-chip {% if search_q and (search_q.lower() in tg.lower()) %}search-hit{% elif tag_q and (tag_q in tg) %}query-hit{% endif %}" href='{{ url_for("index_page.index") }}?tag={{ tg }}'>{{ tg }}</a>
    {% endfor %}
    {% if e.detail_tags|length > 18 %}
      <span class="muted">+{{ e.detail_tags|length - 18 }}</span>
    {% endif %}
  </div>
  {% endif %}
  
  <!-- Content Section -->
  <div class="content-section">
    <div class="summary-section">
      <div class='preview-html collapsed'>{{ e.preview_html | safe }}</div>
    </div>
  </div>
  
  <!-- Footer Section -->
  <div class='card-actions'>
    <div class="primary-actions">
      {% if show_read %}
        <a class='remove-read-link action-btn secondary-btn'>ä»å·²è¯»åˆ—è¡¨ç§»é™¤</a>
      {% elif show_favorites %}
        <a class='remove-favorite-link action-btn secondary-btn'>ä»æ”¶è—åˆ—è¡¨ç§»é™¤</a>
      {% elif show_todo %}
        <a class='remove-todo-link action-btn secondary-btn'>ä»å¾…è¯»ç§»é™¤</a>
        {% if uid %}
          <a class='mark-read-link action-btn secondary-btn'>âœ“ æ ‡è®°ä¸ºå·²è¯»</a>
        {% else %}
          <a class='mark-read-link action-btn secondary-btn disabled'>âœ“ æ ‡è®°ä¸ºå·²è¯»</a>
        {% endif %}
      {% else %}
        {% if uid %}
          <a class='mark-read-link action-btn secondary-btn'>âœ“ æ ‡è®°ä¸ºå·²è¯»</a>
        {% else %}
          <a class='mark-read-link action-btn secondary-btn disabled'>âœ“ æ ‡è®°ä¸ºå·²è¯»</a>
        {% endif %}
      {% endif %}
      {% if uid and (not show_favorites) %}
        <a class='favorite-link action-btn secondary-btn' data-favorited='{{ 'true' if e.is_favorited else 'false' }}'>
          {% if e.is_favorited %}â­ å–æ¶ˆæ”¶è—{% else %}â˜† æ”¶è—{% endif %}
        </a>
      {% elif not uid and (not show_favorites) %}
        <a class='favorite-link action-btn secondary-btn disabled'>â˜† æ”¶è—</a>
      {% endif %}
      {% if uid and (not show_favorites) and (not show_todo) and (not show_read) %}
        <a class='add-todo-link action-btn secondary-btn'>ğŸ“Œ å¾…è¯»</a>
      {% elif not uid and (not show_favorites) and (not show_todo) and (not show_read) %}
        <a class='add-todo-link action-btn secondary-btn disabled'>ğŸ“Œ å¾…è¯»</a>
      {% endif %}
      <a class='toggle-link action-btn secondary-btn'>å±•å¼€</a>
    </div>
    <div class="secondary-actions">
      <a target='_blank' href='https://arxiv.org/pdf/{{ e.id }}.pdf' class='action-btn'>
        ğŸ“„ æ‰“å¼€åŸæ–‡ PDF
      </a>
    </div>
    
  </div>
  
  <!-- Metadata Section -->
  {% if e.read_time or e.favorite_time or e.todo_time %}
  <div class='paper-metadata'>
    <div class='metadata-row'>
      {% if e.read_time %}
      <div class='metadata-item read'>
        <span class='metadata-icon'>ğŸ“–</span>
        <div class='metadata-content'>
          <span class='metadata-label'>å·²è¯»</span>
          <span class='metadata-value'>{{ e.read_time[5:10] }} {{ e.read_time[11:16] }}</span>
        </div>
      </div>
      {% endif %}
      {% if e.favorite_time %}
      <div class='metadata-item favorite'>
        <span class='metadata-icon'>â­</span>
        <div class='metadata-content'>
          <span class='metadata-label'>æ”¶è—</span>
          <span class='metadata-value'>{{ e.favorite_time[5:10] }} {{ e.favorite_time[11:16] }}</span>
        </div>
      </div>
      {% endif %}
      {% if e.todo_time %}
      <div class='metadata-item todo'>
        <span class='metadata-icon'>ğŸ“Œ</span>
        <div class='metadata-content'>
          <span class='metadata-label'>å¾…è¯»</span>
          <span class='metadata-value'>{{ e.todo_time[5:10] }} {{ e.todo_time[11:16] }}</span>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
  {% endif %}
</article>
