<!-- Mobile-Responsive Header -->
<header>
  <div class="header-left">
    <h1>
      {% if show_back_link %}
        <a href='{{ url_for("index_page.index") }}'>â† è¿”å›åˆ—è¡¨</a>
      {% else %}
        <a href='{{ url_for("index_page.index") }}'>ğŸ“š arXivæœ€æ–°AIè®ºæ–‡é€Ÿè§ˆé€Ÿå­¦</a>
      {% endif %}
    </h1>
  </div>
  
  <!-- Desktop Navigation -->
  <div class="page-header-right desktop-nav">
    {% if uid and not show_back_link %}
      <a href="{{ url_for('index_page.read_papers') }}" class="nav-btn">å·²è¯»è®ºæ–‡</a>
      <a href="{{ url_for('index_page.favorite_papers') }}" class="nav-btn">æ”¶è—è®ºæ–‡</a>
      <a href="{{ url_for('index_page.todo_papers') }}" class="nav-btn">å¾…è¯»è®ºæ–‡</a>
      {% if uid in admin_users %}
      <button id='admin-fetch-btn' class="nav-btn admin-btn" title="è·å–æœ€æ–°è®ºæ–‡æ‘˜è¦">è·å–æœ€æ–°</button>
      <a href="{{ url_for('visitor_stats.stats_dashboard') }}" class="nav-btn" title="è®¿é—®ç»Ÿè®¡">è®¿é—®ç»Ÿè®¡</a>
      {% endif %}
      <span class="user-chip" id="user-name" style="cursor: pointer;" title="ç‚¹å‡»è®¾ç½®å¯†ç ">{{ uid }}</span>
      <button id='logout-btn' class="nav-btn logout-btn">é€€å‡º</button>
    {% elif not show_back_link %}
      <form id='user-form' method='POST' action='{{ url_for("user_management.set_user") }}' class="login-form">
        <input name='uid' placeholder='è¾“å…¥ç”¨æˆ·å' required class="login-input">
        <input name='password' type='password' placeholder='å¯†ç ï¼ˆç®¡ç†å‘˜å¿…å¡«ï¼‰' class="login-input" id="password-input" style="display: none;">
        <button type='submit' class="nav-btn login-btn">è¿›å…¥</button>
      </form>
    {% endif %}
    
    <button id="theme-toggle" class="theme-btn" type="button" aria-label="åˆ‡æ¢ä¸»é¢˜" title="åˆ‡æ¢ä¸»é¢˜" data-icon-light="ğŸŒ™" data-icon-dark="â˜€ï¸">ğŸŒ™</button>
  </div>

  <!-- Mobile Menu Button -->
  <button id="mobile-menu-toggle" class="mobile-menu-btn" aria-label="æ‰“å¼€èœå•" title="æ‰“å¼€èœå•">
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
  </button>
</header>

<!-- Password Management Modal -->
<div id="password-modal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>å¯†ç ç®¡ç†</h3>
      <span class="close" id="close-password-modal">&times;</span>
    </div>
    <div class="modal-body">
      <div id="password-status" class="password-status"></div>
      
      <!-- Set Password Form -->
      <div id="set-password-form" style="display: none;">
        <h4>è®¾ç½®å¯†ç </h4>
        <form id="set-password-form-element">
          <div class="form-group">
            <label for="new-password">æ–°å¯†ç :</label>
            <input type="password" id="new-password" name="password" required minlength="6" placeholder="è‡³å°‘6ä¸ªå­—ç¬¦">
          </div>
          <div class="form-group">
            <label for="confirm-password">ç¡®è®¤å¯†ç :</label>
            <input type="password" id="confirm-password" name="confirm_password" required minlength="6" placeholder="å†æ¬¡è¾“å…¥å¯†ç ">
          </div>
          <button type="submit" class="btn btn-primary">è®¾ç½®å¯†ç </button>
        </form>
      </div>
      
      <!-- Change Password Form -->
      <div id="change-password-form" style="display: none;">
        <h4>ä¿®æ”¹å¯†ç </h4>
        <form id="change-password-form-element">
          <div class="form-group">
            <label for="old-password">å½“å‰å¯†ç :</label>
            <input type="password" id="old-password" name="old_password" required placeholder="è¾“å…¥å½“å‰å¯†ç ">
          </div>
          <div class="form-group">
            <label for="change-new-password">æ–°å¯†ç :</label>
            <input type="password" id="change-new-password" name="new_password" required minlength="6" placeholder="è‡³å°‘6ä¸ªå­—ç¬¦">
          </div>
          <div class="form-group">
            <label for="change-confirm-password">ç¡®è®¤æ–°å¯†ç :</label>
            <input type="password" id="change-confirm-password" name="confirm_password" required minlength="6" placeholder="å†æ¬¡è¾“å…¥æ–°å¯†ç ">
          </div>
          <button type="submit" class="btn btn-primary">ä¿®æ”¹å¯†ç </button>
        </form>
      </div>
      
      <!-- Remove Password Form -->
      <div id="remove-password-form" style="display: none;">
        <h4>ç§»é™¤å¯†ç </h4>
        <form id="remove-password-form-element">
          <div class="form-group">
            <label for="remove-password">å½“å‰å¯†ç :</label>
            <input type="password" id="remove-password" name="password" required placeholder="è¾“å…¥å½“å‰å¯†ç ä»¥ç¡®è®¤">
          </div>
          <button type="submit" class="btn btn-danger">ç§»é™¤å¯†ç </button>
        </form>
      </div>
      
      <div class="modal-actions" id="modal-actions" style="display: none;">
        <button id="toggle-password-form" class="btn btn-secondary">åˆ‡æ¢æ“ä½œ</button>
      </div>
    </div>
  </div>
</div>

<!-- Mobile Navigation Overlay -->
<div id="mobile-nav-overlay" class="mobile-nav-overlay">
  <div class="mobile-nav-content">
    <div class="mobile-nav-header">
      <h2>èœå•</h2>
      <button id="mobile-nav-close" class="mobile-nav-close" aria-label="å…³é—­èœå•">Ã—</button>
    </div>
    
    <div class="mobile-nav-body">
      {% if uid and not show_back_link %}
        <a href="{{ url_for('index_page.read_papers') }}" class="mobile-nav-item">
          <span class="nav-icon">ğŸ“–</span>
          <span class="nav-text">å·²è¯»è®ºæ–‡</span>
        </a>
        <a href="{{ url_for('index_page.favorite_papers') }}" class="mobile-nav-item">
          <span class="nav-icon">â­</span>
          <span class="nav-text">æ”¶è—è®ºæ–‡</span>
        </a>
        <a href="{{ url_for('index_page.todo_papers') }}" class="mobile-nav-item">
          <span class="nav-icon">ğŸ“Œ</span>
          <span class="nav-text">å¾…è¯»è®ºæ–‡</span>
        </a>
        {% if uid in admin_users %}
        <button id='mobile-admin-fetch-btn' class="mobile-nav-item mobile-nav-btn">
          <span class="nav-icon">ğŸ”„</span>
          <span class="nav-text">è·å–æœ€æ–°</span>
        </button>
        <a href="{{ url_for('visitor_stats.stats_dashboard') }}" class="mobile-nav-item">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">è®¿é—®ç»Ÿè®¡</span>
        </a>
        {% endif %}
        <div class="mobile-nav-divider"></div>
        <div class="mobile-nav-item mobile-user-info">
          <span class="nav-icon">ğŸ‘¤</span>
          <span class="nav-text">{{ uid }}</span>
        </div>
        <button id='mobile-logout-btn' class="mobile-nav-item mobile-nav-btn mobile-logout-btn">
          <span class="nav-icon">ğŸšª</span>
          <span class="nav-text">é€€å‡º</span>
        </button>
      {% elif not show_back_link %}
        <form id='mobile-user-form' method='POST' action='{{ url_for("user_management.set_user") }}' class="mobile-login-form">
          <div class="mobile-nav-item mobile-login-item">
            <span class="nav-icon">ğŸ‘¤</span>
            <input name='uid' placeholder='è¾“å…¥ç”¨æˆ·å' required class="mobile-login-input">
          </div>
          <button type='submit' class="mobile-nav-item mobile-nav-btn mobile-login-btn">
            <span class="nav-icon">ğŸš€</span>
            <span class="nav-text">è¿›å…¥</span>
          </button>
        </form>
      {% endif %}
      
      <div class="mobile-nav-divider"></div>
      <button id="mobile-theme-toggle" class="mobile-nav-item mobile-nav-btn">
        <span class="nav-icon">ğŸŒ™</span>
        <span class="nav-text">åˆ‡æ¢ä¸»é¢˜</span>
      </button>
    </div>
  </div>
</div>
