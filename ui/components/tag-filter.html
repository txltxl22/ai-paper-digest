<!-- Modern Tag Filter Component -->
<form id="tag-filter" method="GET" action="{{ url_for('index_page.index') }}" class="filters-panel">
  <div class="filter-header">
    <div class="filter-title">
      <span class="filter-icon">ğŸ·ï¸</span>
      <span class="filter-text">æ ‡ç­¾ç­›é€‰</span>
    </div>
    <div class="filter-actions">
      <a href="{{ url_for('index_page.index') }}" class="filter-btn clear-btn">æ¸…é™¤ç­›é€‰</a>
    </div>
  </div>

  <div class="filter-content">
    <!-- Search Input -->
    <div class="search-section">
      <div class="search-group">
        <input type="text" name="q" placeholder="æœç´¢æ ‡ç­¾..." value="{{ tag_query or '' }}" class="search-input" />
        <button type="submit" class="search-btn">
          <span class="search-icon">ğŸ”</span>
          <span class="search-text">æœç´¢</span>
        </button>
      </div>
    </div>

    <!-- Top Tags -->
    {% if top_cloud and top_cloud|length %}
    <div class="filter-section top-tags-section">
      <div class="section-header">
        <span class="section-title">å¤§ç±»æ ‡ç­¾</span>
      </div>
      <div class="top-chips">
        {% for t in top_cloud %}
          <label class="top-chip {% if active_tops and (t.name in active_tops) %}checked{% endif %}">
            <input type="checkbox" name="top" value="{{ t.name }}" {% if active_tops and (t.name in active_tops) %}checked{% endif %}>
            <span class="chip-text">{{ t.name }}</span>
            <span class="chip-count">{{ t.count }}</span>
          </label>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Detail Tags -->
    <div class="filter-section detail-tags-section">
      <div class="section-header">
        <span class="section-title">æ‰€æœ‰æ ‡ç­¾</span>
        <button type="button" id="toggle-detail-chips" class="toggle-btn" style="display:none;">
          <span class="toggle-text">å±•å¼€å…¨éƒ¨</span>
          <span class="toggle-icon">â–¾</span>
        </button>
      </div>
      <div class="detail-chips" id="detail-chips" data-query="{{ tag_query or '' }}">
        {% for t in tag_cloud %}
          <a href="{{ url_for('index_page.index') }}?tag={{ t.name }}" class="tag-chip {% if active_tag == t.name %}active{% endif %} {% if tag_query and (tag_query in t.name) %}query-hit{% endif %}">
            <span class="chip-text">{{ t.name }}</span>
            <span class="chip-count">{{ t.count }}</span>
          </a>
        {% endfor %}
      </div>
    </div>
  </div>
</form>
